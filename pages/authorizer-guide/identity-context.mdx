---
name: Identity Context
---

# Identity Context

When an Authorizer evaluates a policy, it receives an Identity Context from the calling application. 
The `mode` property of that Identity Context instructs the Authorizer how to identify the user:
* ANONYMOUS: the policy is evaluated without a user context
* JWT: the user context is extracted from the `sub` claim of the JSON Web Token (JWT) passed in the `Authorization` header
* MANUAL: the user context is provided as part of the request

In the JWT and MANUAL cases, the Authorizer will look up the user identity in its local directory clone 
(known as the Edge Directory Service, or EDS). It will then load the user context and make it available 
to the Policy as `input.user`. 

## Setting the Identity Context

The `is`, `query`, and `decisiontree` API calls all take an `identityContext` map:

`POST .../api/v1/authz/is`
```json
{
  "identityContext": {
    "identity": "[aserto-user-guid]",
    "mode": "MANUAL"
  }, ...
}
```

To access the properties of the user in a policy, you can use `input.user`:

```rego
package sample.GET.api.orders
default allowed = false

allowed {
  input.user.attributes.department == "Sales"
}
```
